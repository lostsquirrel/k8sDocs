<!doctype html>
<html lang="zh" class="no-js">
  <head>
    



<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.75.1" />

<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">

<link rel="shortcut icon" type="image/png" href="/k8sDocs/images/favicon.png">
<link rel="apple-touch-icon" href="/k8sDocs/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="manifest" href="/k8sDocs/manifest.webmanifest">
<link rel="apple-touch-icon" href="/k8sDocs/images/kubernetes-192x192.png">

<title>毒点(Taint)与耐受性(Toleration) | Kubernetes</title><meta property="og:title" content="毒点(Taint)与耐受性(Toleration)" />
<meta property="og:description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lostsquirrel.github.io/k8sDocs/docs/concepts/scheduling-eviction/taint-and-toleration/" />
<meta property="article:modified_time" content="2021-02-03T14:44:36+08:00" /><meta property="og:site_name" content="Kubernetes" />
<meta itemprop="name" content="毒点(Taint)与耐受性(Toleration)">
<meta itemprop="description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods,">
<meta itemprop="dateModified" content="2021-02-03T14:44:36+08:00" />
<meta itemprop="wordCount" content="4990">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="毒点(Taint)与耐受性(Toleration)"/>
<meta name="twitter:description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods,"/>





<link rel="preload" href="/k8sDocs/scss/main.min.537757ec8e00d87ec206229d5725b6d05e078dd447818e448f0802685603e730.css" as="style">
<link href="/k8sDocs/scss/main.min.537757ec8e00d87ec206229d5725b6d05e078dd447818e448f0802685603e730.css" rel="stylesheet" integrity="">


<script src="/k8sDocs/js/jquery-3.3.1.min.js" ></script>





<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "url": "https://kubernetes.io",
    "logo": "https://kubernetes.io/images/favicon.png",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://lostsquirrel.github.io/k8sDocs/search/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }

  }
</script>
<meta name="theme-color" content="#326ce5">




<link rel="stylesheet" href=/k8sDocs/css/base_fonts.css>

<link rel="stylesheet" href="/k8sDocs/css/jquery-ui.min.css">
<link rel="stylesheet" href="/k8sDocs/css/callouts.css">
<link rel="stylesheet" href="/k8sDocs/css/custom.css">
<link rel="stylesheet" href="/k8sDocs/css/custom-jekyll/tags.css">



<meta name="description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods,">
<meta property="og:description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods,">
<meta name="twitter:description" content="PodsPod 表示集群中运行的一组容器的集合 that *attracts* them to a set of nodes一个节点就是 k8s 中的一个工作机 (either as a preference or a hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods. _Tolerations_ are applied to pods,">
<meta property="og:url" content="https://lostsquirrel.github.io/k8sDocs/docs/concepts/scheduling-eviction/taint-and-toleration/">
<meta property="og:title" content="毒点(Taint)与耐受性(Toleration)">
<meta name="twitter:title" content="毒点(Taint)与耐受性(Toleration)">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />

<meta name="twitter:image:alt" content="Kubernetes">

<meta property="og:image" content="/k8sDocs/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">



<script src="/k8sDocs/js/script.js"></script>


    <title>毒点(Taint)与耐受性(Toleration) | Kubernetes</title>
  </head>
  <body class="td-page td-documentation">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark  flex-row td-navbar" data-auto-burger="primary">
        <a class="navbar-brand" href="/k8sDocs/"></a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">

		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			
			
			<li class="nav-item mr-2 mb-lg-0">
				
				<a class="nav-link active" href="/k8sDocs/docs/" >Documentation</span></a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		</ul>
	</div>
  

</nav>

      
      <div class="header-filler"></div>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-md-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center d-lg-none">
    

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Kubernetes Documentation</a>
  </li>
  <ul>
    <li class="collapse show" id="k8sdocsdocs">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">概念(Concepts)</a>
  </li>
  <ul>
    <li class="collapse show" id="k8sdocsdocsconcepts">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/overview/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">概览</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsoverview">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverview00-what-is-k8s" href="/k8sDocs/docs/concepts/overview/00-what-is-k8s/">k8s 是什么</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverview01-components" href="/k8sDocs/docs/concepts/overview/01-components/">k8s 组件</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewkubernetes-api" href="/k8sDocs/docs/concepts/overview/kubernetes-api/">k8s API 说明</a>
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/overview/working-with-objects/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">k8s 对象管理</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsoverviewworking-with-objects">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objects00-kubernetes-objects" href="/k8sDocs/docs/concepts/overview/working-with-objects/00-kubernetes-objects/">k8s 对象介绍</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objectsnames" href="/k8sDocs/docs/concepts/overview/working-with-objects/names/">对象命令与ID</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objects02-namespace" href="/k8sDocs/docs/concepts/overview/working-with-objects/02-namespace/">命名空间(Namespaces)</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objectslabels" href="/k8sDocs/docs/concepts/overview/working-with-objects/labels/">标签和标签选择器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objects04-annotation" href="/k8sDocs/docs/concepts/overview/working-with-objects/04-annotation/">注解 (Annotations)</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objects05-field-selectors" href="/k8sDocs/docs/concepts/overview/working-with-objects/05-field-selectors/">字段选择器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsoverviewworking-with-objects06-common-labels" href="/k8sDocs/docs/concepts/overview/working-with-objects/06-common-labels/">标签设置指导</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/architecture/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">集群架构</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsarchitecture">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsarchitecturenodes" href="/k8sDocs/docs/concepts/architecture/nodes/">节点</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsarchitecturecontrol-plane-node-communication" href="/k8sDocs/docs/concepts/architecture/control-plane-node-communication/">控制中心与节点的通信</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsarchitecturecontroller" href="/k8sDocs/docs/concepts/architecture/controller/">控制器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsarchitecturecloud-controller" href="/k8sDocs/docs/concepts/architecture/cloud-controller/">Cloud Controller Manager</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/containers/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">容器</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptscontainers">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptscontainers00-images" href="/k8sDocs/docs/concepts/containers/00-images/">镜像</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptscontainers01-container-environment" href="/k8sDocs/docs/concepts/containers/01-container-environment/">容器环境</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptscontainers02-runtime-class" href="/k8sDocs/docs/concepts/containers/02-runtime-class/">Runtime Class</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptscontainerscontainer-lifecycle-hooks" href="/k8sDocs/docs/concepts/containers/container-lifecycle-hooks/">容器生命周期钩子</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/workloads/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">工作负载(Workload)</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsworkloads">
      
      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/workloads/pods/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Pod</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsworkloadspods">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodspod-lifecycle" href="/k8sDocs/docs/concepts/workloads/pods/pod-lifecycle/">Pod 生命周期</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodsinit-containers" href="/k8sDocs/docs/concepts/workloads/pods/init-containers/">初始化容器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodspod-topology-spread-constraints" href="/k8sDocs/docs/concepts/workloads/pods/pod-topology-spread-constraints/">Pod 拓扑分布约束条件</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodspodpreset" href="/k8sDocs/docs/concepts/workloads/pods/podpreset/">Pod 预设信息</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodsdisruptions" href="/k8sDocs/docs/concepts/workloads/pods/disruptions/">Disruptions</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadspodsephemeral-containers" href="/k8sDocs/docs/concepts/workloads/pods/ephemeral-containers/">临时容器</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/workloads/controllers/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">控制器</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsworkloadscontrollers">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersdeployment" href="/k8sDocs/docs/concepts/workloads/controllers/deployment/">Deployment</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersreplicaset" href="/k8sDocs/docs/concepts/workloads/controllers/replicaset/">ReplicaSet</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersstatefulset" href="/k8sDocs/docs/concepts/workloads/controllers/statefulset/">StatefulSet</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersdaemonset" href="/k8sDocs/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersjob" href="/k8sDocs/docs/concepts/workloads/controllers/job/">Job</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersgarbage-collection" href="/k8sDocs/docs/concepts/workloads/controllers/garbage-collection/">垃圾回收</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersttlafterfinished" href="/k8sDocs/docs/concepts/workloads/controllers/ttlafterfinished/">用于已完成资源的 TTL 控制器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollerscron-jobs" href="/k8sDocs/docs/concepts/workloads/controllers/cron-jobs/">CronJob</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsworkloadscontrollersreplicationcontroller" href="/k8sDocs/docs/concepts/workloads/controllers/replicationcontroller/">ReplicationController</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/services-networking/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Service, 负载均衡, 网络</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsservices-networking">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingservice" href="/k8sDocs/docs/concepts/services-networking/service/">Service</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingservice-topology" href="/k8sDocs/docs/concepts/services-networking/service-topology/">Service Topology</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingdns-pod-service" href="/k8sDocs/docs/concepts/services-networking/dns-pod-service/">Service 和 Pod 的 DNS</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingconnect-applications-service" href="/k8sDocs/docs/concepts/services-networking/connect-applications-service/">通过 Service 连接应用</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingendpoint-slices" href="/k8sDocs/docs/concepts/services-networking/endpoint-slices/">EndpointSlice</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingingress" href="/k8sDocs/docs/concepts/services-networking/ingress/">Ingress</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingingress-controllers" href="/k8sDocs/docs/concepts/services-networking/ingress-controllers/">Ingress 控制器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingnetwork-policies" href="/k8sDocs/docs/concepts/services-networking/network-policies/">网络策略</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingadd-entries-to-pod-etc-hosts-with-host-aliases" href="/k8sDocs/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/">通过 HostAliases 向 Pod 的 /etc/hosts 文件中添加条目</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsservices-networkingdual-stack" href="/k8sDocs/docs/concepts/services-networking/dual-stack/">IPv4/IPv6 双栈</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/storage/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">存储(Storage)</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsstorage">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragevolumes" href="/k8sDocs/docs/concepts/storage/volumes/">卷(Volume)</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragepersistent-volumes" href="/k8sDocs/docs/concepts/storage/persistent-volumes/">持久化卷(PV)</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragevolume-snapshots" href="/k8sDocs/docs/concepts/storage/volume-snapshots/">卷快照</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragevolume-pvc-datasource" href="/k8sDocs/docs/concepts/storage/volume-pvc-datasource/">CSI 卷克隆</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragestorage-classes" href="/k8sDocs/docs/concepts/storage/storage-classes/">StorageClass</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragevolume-snapshot-classes" href="/k8sDocs/docs/concepts/storage/volume-snapshot-classes/">VolumeSnapshotClass</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragedynamic-provisioning" href="/k8sDocs/docs/concepts/storage/dynamic-provisioning/">卷动态供应</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragestorage-capacity" href="/k8sDocs/docs/concepts/storage/storage-capacity/">存储容量</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstorageephemeral-volumes" href="/k8sDocs/docs/concepts/storage/ephemeral-volumes/">临时卷</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsstoragestorage-limits" href="/k8sDocs/docs/concepts/storage/storage-limits/">节点级别的卷限制</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/configuration/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">配置</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptsconfiguration">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationoverview" href="/k8sDocs/docs/concepts/configuration/overview/">配置最佳实践</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationconfigmap" href="/k8sDocs/docs/concepts/configuration/configmap/">ConfigMap</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationsecret" href="/k8sDocs/docs/concepts/configuration/secret/">Secret</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationmanage-resources-containers" href="/k8sDocs/docs/concepts/configuration/manage-resources-containers/">管理容器资源</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationorganize-cluster-access-kubeconfig" href="/k8sDocs/docs/concepts/configuration/organize-cluster-access-kubeconfig/">使用 kubeconfig 文件组织集群访问</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsconfigurationpod-priority-preemption" href="/k8sDocs/docs/concepts/configuration/pod-priority-preemption/">Pod 优先级与抢占</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/security/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">安全</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptssecurity">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptssecurityoverview" href="/k8sDocs/docs/concepts/security/overview/">云原生安全概述</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptssecuritypod-security-standards" href="/k8sDocs/docs/concepts/security/pod-security-standards/">Pod 安全标准</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptssecuritycontrolling-access" href="/k8sDocs/docs/concepts/security/controlling-access/">对 k8s API 的访问控制</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/policy/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">策略</a>
  </li>
  <ul>
    <li class="collapse " id="k8sdocsdocsconceptspolicy">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptspolicylimit-range" href="/k8sDocs/docs/concepts/policy/limit-range/">范围限制</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptspolicyresource-quotas" href="/k8sDocs/docs/concepts/policy/resource-quotas/">资源配额</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptspolicypod-security-policy" href="/k8sDocs/docs/concepts/policy/pod-security-policy/">Pod 安全策略</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptspolicypid-limiting" href="/k8sDocs/docs/concepts/policy/pid-limiting/">进程 ID 的限制与保留</a>
      
      
    </li>
  </ul>
</ul>

      
      
      
      






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/k8sDocs/docs/concepts/scheduling-eviction/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">调度与驱逐</a>
  </li>
  <ul>
    <li class="collapse show" id="k8sdocsdocsconceptsscheduling-eviction">
      
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page " id="m-k8sdocsdocsconceptsscheduling-evictionkube-scheduler" href="/k8sDocs/docs/concepts/scheduling-eviction/kube-scheduler/">k8s 中的调度器</a>
      
      
      
      
      
      <a class="td-sidebar-link td-sidebar-link__page  active" id="m-k8sdocsdocsconceptsscheduling-evictiontaint-and-toleration" href="/k8sDocs/docs/concepts/scheduling-eviction/taint-and-toleration/">毒点(Taint)与耐受性(Toleration)</a>
      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		













<li class="breadcrumb-item" >
	<a href="https://lostsquirrel.github.io/k8sDocs/docs/">Kubernetes Documentation</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://lostsquirrel.github.io/k8sDocs/docs/concepts/">概念(Concepts)</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://lostsquirrel.github.io/k8sDocs/docs/concepts/scheduling-eviction/">调度与驱逐</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://lostsquirrel.github.io/k8sDocs/docs/concepts/scheduling-eviction/taint-and-toleration/">毒点(Taint)与耐受性(Toleration)</a>
</li>

	</ol>
</nav	>

            
              
            
              
    <div class="td-content">
    
<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/zh/docs/concepts/scheduling-eviction/taint-and-toleration.md" id="editPageButton" target="_blank" data-proofer-ignore>
    Edit This Page
  </a>
</p>

  <h1>毒点(Taint)与耐受性(Toleration)</h1>
  
  

<!--
---
reviewers:
- davidopp
- kevin-wangzefeng
- bsalamat
title: Taints and Tolerations
content_type: concept
weight: 40
---
 -->
<!-- overview -->
<!--
[_Node affinity_](/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity),
is a property of <a class='glossary-tooltip' href='/k8sDocs/concepts/workloads/pods/' target='_blank'>Pods<span class='tooltip-text'>Pod 表示集群中运行的一组容器的集合</span>
</a> that *attracts* them to
a set of <a class='glossary-tooltip' href='/k8sDocs/2-concepts/01-architecture/00-nodes/' target='_blank'>nodes<span class='tooltip-text'>一个节点就是 k8s 中的一个工作机</span>
</a> (either as a preference or a
hard requirement). _Taints_ are the opposite -- they allow a node to repel a set of pods.

_Tolerations_ are applied to pods, and allow (but do not require) the pods to schedule
onto nodes with matching taints.

Taints and tolerations work together to ensure that pods are not scheduled
onto inappropriate nodes. One or more taints are applied to a node; this
marks that the node should not accept any pods that do not  the taints.
-->
<p><a href="/k8sDocs/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity"><em>节点亲和性</em></a>,
是
<a class='glossary-tooltip' href='/k8sDocs/concepts/workloads/pods/' target='_blank'>Pod<span class='tooltip-text'>Pod 表示集群中运行的一组容器的集合</span>
</a>
的一个属性，这个属性会 <em>吸引</em> 它们到一个
<a class='glossary-tooltip' href='/k8sDocs/2-concepts/01-architecture/00-nodes/' target='_blank'>节点<span class='tooltip-text'>一个节点就是 k8s 中的一个工作机</span>
</a>
集合(无论是偏好还是硬性要求)。
<em>毒点(Taint)</em> 则正好相反 &ndash; 它们允许一个节点排斥特定集合内的 Pod。</p>
<p><em>耐受性(Toleration)</em> 是会应用到 Pod 上的， 它允许(但不是必须)调度到拥有对应 毒点(Taint)的节点上。</p>
<p>毒点(Taint)和耐受性(Toleration) 一起工作，以保证 Pod 不会调度到不合适的节点上。一个节点可以
应用一个或多个毒点(Taint)；这个标记表示节点不应该接收任意不能耐受(tolerate) 这些毒点(Taint)
的 Pod。</p>
<!-- body -->
<!--
## Concepts

You add a taint to a node using [kubectl taint](/docs/reference/generated/kubectl/kubectl-commands#taint).
For example,

```shell
kubectl taint nodes node1 key1=value1:NoSchedule
```

places a taint on node `node1`. The taint has key `key1`, value `value1`, and taint effect `NoSchedule`.
This means that no pod will be able to schedule onto `node1` unless it has a matching toleration.

To remove the taint added by the command above, you can run:
```shell
kubectl taint nodes node1 key1=value1:NoSchedule-
```

You specify a toleration for a pod in the PodSpec. Both of the following tolerations "match" the
taint created by the `kubectl taint` line above, and thus a pod with either toleration would be able
to schedule onto `node1`:

```yaml
tolerations:
- key: "key1"
  operator: "Equal"
  value: "value1"
  effect: "NoSchedule"
```

```yaml
tolerations:
- key: "key1"
  operator: "Exists"
  effect: "NoSchedule"
```

Here's an example of a pod that uses tolerations:



 













<table class="includecode" id="podspod-with-tolerationyaml">
    <thead>
        <tr>
            <th>
                <a href="https://%25!s%28%3cnil%3e%29/master/content/zh/examples/pods/pod-with-toleration.yaml" download="pods/pod-with-toleration.yaml">
                    <code>pods/pod-with-toleration.yaml</code>
                </a>
                <img src="/k8sDocs/images/copycode.svg" style="max-height:24px; cursor: pointer" onclick="copyCode('podspod-with-tolerationyaml')" title="Copy pods/pod-with-toleration.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">env</span>: <span style="color:#ae81ff">test</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx</span>
    <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;example-key&#34;</span>
    <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Exists&#34;</span>
    <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoSchedule&#34;</span>
</code></pre></div>  </td>
        </tr>
    </tbody>
</table>



The default value for `operator` is `Equal`.

A toleration "matches" a taint if the keys are the same and the effects are the same, and:

* the `operator` is `Exists` (in which case no `value` should be specified), or
* the `operator` is `Equal` and the `value`s are equal.

<blockquote class="note">
  <div><strong>说明：</strong> <p>There are two special cases:</p>
<p>An empty <code>key</code> with operator <code>Exists</code> matches all keys, values and effects which means this
will tolerate everything.</p>
<p>An empty <code>effect</code> matches all effects with key <code>key1</code>.</p>
</div>
</blockquote>


The above example used `effect` of `NoSchedule`. Alternatively, you can use `effect` of `PreferNoSchedule`.
This is a "preference" or "soft" version of `NoSchedule` -- the system will *try* to avoid placing a
pod that does not tolerate the taint on the node, but it is not required. The third kind of `effect` is
`NoExecute`, described later.

You can put multiple taints on the same node and multiple tolerations on the same pod.
The way Kubernetes processes multiple taints and tolerations is like a filter: start
with all of a node's taints, then ignore the ones for which the pod has a matching toleration; the
remaining un-ignored taints have the indicated effects on the pod. In particular,

* if there is at least one un-ignored taint with effect `NoSchedule` then Kubernetes will not schedule
the pod onto that node
* if there is no un-ignored taint with effect `NoSchedule` but there is at least one un-ignored taint with
effect `PreferNoSchedule` then Kubernetes will *try* to not schedule the pod onto the node
* if there is at least one un-ignored taint with effect `NoExecute` then the pod will be evicted from
the node (if it is already running on the node), and will not be
scheduled onto the node (if it is not yet running on the node).

For example, imagine you taint a node like this

```shell
kubectl taint nodes node1 key1=value1:NoSchedule
kubectl taint nodes node1 key1=value1:NoExecute
kubectl taint nodes node1 key2=value2:NoSchedule
```

And a pod has two tolerations:

```yaml
tolerations:
- key: "key1"
  operator: "Equal"
  value: "value1"
  effect: "NoSchedule"
- key: "key1"
  operator: "Equal"
  value: "value1"
  effect: "NoExecute"
```

In this case, the pod will not be able to schedule onto the node, because there is no
toleration matching the third taint. But it will be able to continue running if it is
already running on the node when the taint is added, because the third taint is the only
one of the three that is not tolerated by the pod.

Normally, if a taint with effect `NoExecute` is added to a node, then any pods that do
not tolerate the taint will be evicted immediately, and pods that do tolerate the
taint will never be evicted. However, a toleration with `NoExecute` effect can specify
an optional `tolerationSeconds` field that dictates how long the pod will stay bound
to the node after the taint is added. For example,

```yaml
tolerations:
- key: "key1"
  operator: "Equal"
  value: "value1"
  effect: "NoExecute"
  tolerationSeconds: 3600
```

means that if this pod is running and a matching taint is added to the node, then
the pod will stay bound to the node for 3600 seconds, and then be evicted. If the
taint is removed before that time, the pod will not be evicted. -->
<h2 id="concepts">概念</h2>
<p>用户可以使用
<a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#taint">kubectl taint</a>
来给一个节点添加一个毒点(Taint),
例如，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl taint nodes node1 key1<span style="color:#f92672">=</span>value1:NoSchedule
</code></pre></div><p>在节点 <code>node1</code> 上放置一个毒点(Taint)。 这个 毒点(Taint)的键是 <code>key1</code>, 值是 <code>value1</code>，
效果是 <code>NoSchedule</code>。 它的含义是如果 Pod 是没有对应的耐受性(Toleration) 就不能调度到节点
<code>node1</code> 上。</p>
<p>要移除上面的命令添加的 毒点(Taint)，可以使用:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl taint nodes node1 key1<span style="color:#f92672">=</span>value1:NoSchedule-
</code></pre></div><p>用户可以在 Pod 的 <code>.spec</code> 中指定耐受性(Toleration)。 下面的两个耐受性(Toleration) 就可以
匹配由上面<code>kubectl taint</code> 命令定义的耐受性(Toleration)，也就是一个 Pod 如果包含以下耐受性(Toleration)
中的任意一个就可以调度到节点  <code>node1</code> 上:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">tolerations</span>:
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;key1&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Equal&#34;</span>
  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;value1&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoSchedule&#34;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">tolerations</span>:
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;key1&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Exists&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoSchedule&#34;</span>
</code></pre></div><p>现在是一个使用耐受性(Toleration)的示例:</p>


 













<table class="includecode" id="podspod-with-tolerationyaml">
    <thead>
        <tr>
            <th>
                <a href="https://%25!s%28%3cnil%3e%29/master/content/zh/examples/pods/pod-with-toleration.yaml" download="pods/pod-with-toleration.yaml">
                    <code>pods/pod-with-toleration.yaml</code>
                </a>
                <img src="/k8sDocs/images/copycode.svg" style="max-height:24px; cursor: pointer" onclick="copyCode('podspod-with-tolerationyaml')" title="Copy pods/pod-with-toleration.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">env</span>: <span style="color:#ae81ff">test</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">containers</span>:
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">nginx</span>
    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">nginx</span>
    <span style="color:#f92672">imagePullPolicy</span>: <span style="color:#ae81ff">IfNotPresent</span>
  <span style="color:#f92672">tolerations</span>:
  - <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;example-key&#34;</span>
    <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Exists&#34;</span>
    <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoSchedule&#34;</span>
</code></pre></div>  </td>
        </tr>
    </tbody>
</table>


<p><code>operator</code> 的默认值是 <code>Equal</code>.</p>
<p>一个耐受性(Toleration)匹配一个毒点(Taint)条件是 键要相同并且效果要一样，同时:</p>
<ul>
<li><code>operator</code> is <code>Exists</code> (这种情况不应该指定值), 或</li>
<li><code>operator</code> is <code>Equal</code> 并且 <code>value</code> 是相等的。</li>
</ul>
<blockquote class="note">
  <div><strong>说明：</strong> <p>还有两种特殊情况:</p>
<p><code>operator</code> is <code>Exists</code>, <code>key</code> 是空表示匹配所有的键，值和效果，也就代表耐受所有毒点(Taint)</p>
<p>如果 <code>effect</code> 是空则匹配键 <code>key1</code> 的所有效果</p>
</div>
</blockquote>

<p>上面示例果使用的 <code>effect</code> 是 <code>NoSchedule</code>. 还有另一个选择是让 <code>effect</code> 使用 <code>PreferNoSchedule</code>.
这是 <code>NoSchedule</code> 的 &ldquo;偏好&rdquo; 或 &ldquo;软&rdquo; 版本 &ndash; 也就是系统会 <em>尝试</em> 避免将那些不能耐受这个
毒点(Taint) 的 Pod 放到这个节点上，但不是一定不能放。 <code>effect</code> 第三个选择是 <code>NoExecute</code> 后面
会介绍。</p>
<p>用户可以在一个节点上添加多个毒点(Taint)，也可以在一个 Pod 上定义多个 耐受性(Toleration).
k8s 处理多个 毒点(Taint)和 耐受性(Toleration)的方式与过虑器类似: 从节点的所有 毒点(Taint)
开始， 然后忽略掉那些与 Pod 耐受性(Toleration)匹配的；剩下的就是对 Pod 生效的毒点(Taint)。
特别是，</p>
<ul>
<li>如果剩下未忽略的毒点(Taint)中至少有一个效果是 <code>NoSchedule</code> 则 k8s 不会将这个 Pod 调度到这个节点上</li>
<li>如果剩下未忽略的毒点(Taint)中没有效果是 <code>NoSchedule</code>， 但是至少有一个效果是 <code>PreferNoSchedule</code>
则 k8s 会 <em>尝试</em> 不将这个 Pod 调度到这个节点上</li>
<li>如果剩下未忽略的毒点(Taint)中至少有一个效果是 <code>NoExecute</code>，则 Pod 会被从节点驱逐(如果 Pod
已经在节点上运行)，或不会被调度到这个节点(如果它还没有在这个节点上运行)</li>
</ul>
<p>例如，假设将一个节点添加如下毒点(Taint)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl taint nodes node1 key1<span style="color:#f92672">=</span>value1:NoSchedule
kubectl taint nodes node1 key1<span style="color:#f92672">=</span>value1:NoExecute
kubectl taint nodes node1 key2<span style="color:#f92672">=</span>value2:NoSchedule
</code></pre></div><p>和一个有以下两个耐受性(Toleration) Pod:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">tolerations</span>:
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;key1&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Equal&#34;</span>
  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;value1&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoSchedule&#34;</span>
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;key1&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Equal&#34;</span>
  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;value1&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoExecute&#34;</span>
</code></pre></div><p>在这种情况下， Pod 是会能调度到这个节点上的， 因为没有一个 耐受性(Toleration)能匹配到第三个
毒点(Taint)。 但如果这个 Pod 在这些毒点(Taint)添加前已经在这个节点上运行，则它还是可以继续在
上面运行，因为 Pod 不耐受的毒点(Taint)只有第三个。</p>
<p>通常情况下，如果一个效果是 <code>NoExecute</code> 的毒点(Taint)被添加到节点上，则所有不能耐受这个毒点(Taint)
的 Pod 立马就会被驱逐，同时耐受这个毒点(Taint) Pod 则永远不会被驱逐。 但是，效果是  <code>NoExecute</code>
的 耐受性(Toleration) 还可以指定一个可选的 <code>tolerationSeconds</code> 字段，表示在节点添加 毒点(Taint)
后 Pod 还可以在节点上保持绑定状态多久。例如，</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">tolerations</span>:
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;key1&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Equal&#34;</span>
  <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#34;value1&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoExecute&#34;</span>
  <span style="color:#f92672">tolerationSeconds</span>: <span style="color:#ae81ff">3600</span>
</code></pre></div><p>的含义就是如果这个 Pod 运行在一个添加了这个耐受性(Toleration)匹配 毒点(Taint)的节点， 则
Pod 会继续与节点保持绑定 3600 秒，然后被驱逐。 如果在这个时间之前，这个 毒点(Taint) 被从该
节点移除，则 Pod 不会被驱逐。</p>
<!--
## Example Use Cases

Taints and tolerations are a flexible way to steer pods *away* from nodes or evict
pods that shouldn't be running. A few of the use cases are

* **Dedicated Nodes**: If you want to dedicate a set of nodes for exclusive use by
a particular set of users, you can add a taint to those nodes (say,
`kubectl taint nodes nodename dedicated=groupName:NoSchedule`) and then add a corresponding
toleration to their pods (this would be done most easily by writing a custom
[admission controller](/docs/reference/access-authn-authz/admission-controllers/)).
The pods with the tolerations will then be allowed to use the tainted (dedicated) nodes as
well as any other nodes in the cluster. If you want to dedicate the nodes to them *and*
ensure they *only* use the dedicated nodes, then you should additionally add a label similar
to the taint to the same set of nodes (e.g. `dedicated=groupName`), and the admission
controller should additionally add a node affinity to require that the pods can only schedule
onto nodes labeled with `dedicated=groupName`.

* **Nodes with Special Hardware**: In a cluster where a small subset of nodes have specialized
hardware (for example GPUs), it is desirable to keep pods that don't need the specialized
hardware off of those nodes, thus leaving room for later-arriving pods that do need the
specialized hardware. This can be done by tainting the nodes that have the specialized
hardware (e.g. `kubectl taint nodes nodename special=true:NoSchedule` or
`kubectl taint nodes nodename special=true:PreferNoSchedule`) and adding a corresponding
toleration to pods that use the special hardware. As in the dedicated nodes use case,
it is probably easiest to apply the tolerations using a custom
[admission controller](/docs/reference/access-authn-authz/admission-controllers/).
For example, it is recommended to use [Extended
Resources](/docs/concepts/configuration/manage-resources-containers/#extended-resources)
to represent the special hardware, taint your special hardware nodes with the
extended resource name and run the
[ExtendedResourceToleration](/docs/reference/access-authn-authz/admission-controllers/#extendedresourcetoleration)
admission controller. Now, because the nodes are tainted, no pods without the
toleration will schedule on them. But when you submit a pod that requests the
extended resource, the `ExtendedResourceToleration` admission controller will
automatically add the correct toleration to the pod and that pod will schedule
on the special hardware nodes. This will make sure that these special hardware
nodes are dedicated for pods requesting such hardware and you don't have to
manually add tolerations to your pods.

* **Taint based Evictions**: A per-pod-configurable eviction behavior
when there are node problems, which is described in the next section.
 -->
<h2 id="example-use-cases">使用场景示例</h2>
<p>毒点(Taint) 和 耐受性(Toleration) 是控制 Pod <em>远离</em> 某些节点或驱逐那些不应该运行的 Pod。
一些使用场景:</p>
<ul>
<li>
<p><strong>专用节点</strong>: 如果想要将一组专用节点让一组特定用户独占，可以在这个节点上添加一个毒点(Taint)
(就比如, <code>kubectl taint nodes nodename dedicated=groupName:NoSchedule</code>)然后在他们
的 Pod 上添加对应的耐受性(Toleration)(实现这个最简单的办法是写一个自定义
<a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/">准入控制</a>
)。
这些有这个耐受性(Toleration)的 Pod 就被允许使用这些毒掉的(专用)节点和集群中的其它节点。
如果想将这些节点给他们独占 <em>并且</em> 确保他们也 <em>只能</em> 使用这些专用节点, 还应该在这一组节点上添加
与毒点(Taint)类似的标签(例如 <code>dedicated=groupName</code>), 然后在准入控制器上另外添加一个节点亲和性
来标这些 Pod 只能调度到那些有 <code>dedicated=groupName</code> 标签的节点。</p>
</li>
<li>
<p><strong>拥有特殊硬件的节点</strong>: 在一个集群中，有一小部分节点有专用的硬件(例如 GPU)，这时就希望不要
将那些不需要这些专用硬件的 Pod 调度到这些节点上， 这样就可以把这些节点留给后来的为那些需要这些专用
硬件的 Pod。 要做到这一点，可以在这些有专用硬件的节点上加毒点(Taint)(例如，
<code>kubectl taint nodes nodename special=true:NoSchedule</code> 或
<code>kubectl taint nodes nodename special=true:PreferNoSchedule</code>
)再在需要这些专用硬件的 Pod 上添加对应的耐受性(Toleration)。 与上面的专用节点使用场景一样，
应用这些 耐受性(Toleration)最简单的方式就是使用自定义
<a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/">准入控制器</a>.
例如推荐使用
<a href="/k8sDocs/docs/concepts/configuration/manage-resources-containers/#extended-resources">扩展资源</a>
来表示特殊的硬件， 使用扩展资源的名称作为节点的 毒点(Taint) 然后运行
<a href="https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#extendedresourcetoleration">ExtendedResourceToleration</a>
准入控制器。 此时， 因为节点上已经打了 毒点(Taint)没有对应耐受性(Toleration)的 Pod 不会调度
到这些节点上。 但当提供一个要求这些扩展资源的 Pod 时， <code>ExtendedResourceToleration</code> 准入
控制器会自动为这些 Pod 添加对应的耐受性(Toleration)，这样这些 Pod 就会被调度到这些有特殊硬件
的节点上。 这会保证这些特殊硬件的节点只会被这些要求这个硬件的 Pod 单独使用，并且不需要手动为这些
Pod 添加耐受性(Toleration)</p>
</li>
</ul>
<ul>
<li><strong>Taint based Evictions</strong>: A per-pod-configurable eviction behavior
when there are node problems, which is described in the next section.</li>
</ul>
<ul>
<li><strong>基于毒点(Taint)的驱逐行为</strong>: 一个每个 Pod 都可配置的驱逐行为就是当节点出问题时进行的，
这会在下一节点介绍。</li>
</ul>
<!--
## Taint based Evictions






<div style="margin-top: 10px; margin-bottom: 10px;">
<b>功能特性状态:</b> <code>Kubernetes v1.18 [stable]</code>
</div>



The `NoExecute` taint effect, mentioned above, affects pods that are already
running on the node as follows

 * pods that do not tolerate the taint are evicted immediately
 * pods that tolerate the taint without specifying `tolerationSeconds` in
   their toleration specification remain bound forever
 * pods that tolerate the taint with a specified `tolerationSeconds` remain
   bound for the specified amount of time

The node controller automatically taints a Node when certain conditions
are true. The following taints are built in:

 * `node.kubernetes.io/not-ready`: Node is not ready. This corresponds to
   the NodeCondition `Ready` being "`False`".
 * `node.kubernetes.io/unreachable`: Node is unreachable from the node
   controller. This corresponds to the NodeCondition `Ready` being "`Unknown`".
 * `node.kubernetes.io/out-of-disk`: Node becomes out of disk.
 * `node.kubernetes.io/memory-pressure`: Node has memory pressure.
 * `node.kubernetes.io/disk-pressure`: Node has disk pressure.
 * `node.kubernetes.io/network-unavailable`: Node's network is unavailable.
 * `node.kubernetes.io/unschedulable`: Node is unschedulable.
 * `node.cloudprovider.kubernetes.io/uninitialized`: When the kubelet is started
    with "external" cloud provider, this taint is set on a node to mark it
    as unusable. After a controller from the cloud-controller-manager initializes
    this node, the kubelet removes this taint.

In case a node is to be evicted, the node controller or the kubelet adds relevant taints
with `NoExecute` effect. If the fault condition returns to normal the kubelet or node
controller can remove the relevant taint(s).

<blockquote class="note">
  <div><strong>说明：</strong> The control plane limits the rate of adding node new taints to nodes. This rate limiting
manages the number of evictions that are triggered when many nodes become unreachable at
once (for example: if there is a network disruption).</div>
</blockquote>


You can specify `tolerationSeconds` for a Pod to define how long that Pod stays bound
to a failing or unresponsive Node.

For example, you might want to keep an application with a lot of local state
bound to node for a long time in the event of network partition, hoping
that the partition will recover and thus the pod eviction can be avoided.
The toleration you set for that Pod might look like:

```yaml
tolerations:
- key: "node.kubernetes.io/unreachable"
  operator: "Exists"
  effect: "NoExecute"
  tolerationSeconds: 6000
```

<blockquote class="note">
  <div><strong>说明：</strong> <p>Kubernetes automatically adds a toleration for
<code>node.kubernetes.io/not-ready</code> and <code>node.kubernetes.io/unreachable</code>
with <code>tolerationSeconds=300</code>,
unless you, or a controller, set those tolerations explicitly.</p>
<p>These automatically-added tolerations mean that Pods remain bound to
Nodes for 5 minutes after one of these problems is detected.</p>
</div>
</blockquote>


[DaemonSet](/docs/concepts/workloads/controllers/daemonset/) pods are created with
`NoExecute` tolerations for the following taints with no `tolerationSeconds`:

  * `node.kubernetes.io/unreachable`
  * `node.kubernetes.io/not-ready`

This ensures that DaemonSet pods are never evicted due to these problems.
 -->
<h2 id="taint-based-evictions">基于毒点(Taint) 的驱逐</h2>





<div style="margin-top: 10px; margin-bottom: 10px;">
<b>功能特性状态:</b> <code>Kubernetes v1.18 [stable]</code>
</div>


<p>上面提到的影响为 <code>NoExecute</code> 毒点(Taint)，对已经在节点上运行的 Pod 的影响如下</p>
<ul>
<li>不能耐受这个 毒点(Taint) 的 Pod 会立马被踢出</li>
<li>能够耐受这个毒点(Taint)并且在耐受定义中没有指定 <code>tolerationSeconds</code> 的 Pod 会一直继续在这个节点上运行</li>
<li>能够耐受这个毒点(Taint)并且在耐受定义中指定了 <code>tolerationSeconds</code> 则会继续在这个节点上运行指定的这个时间</li>
</ul>
<p>节点控制器会在特定条件满足是自动给节点添加 毒点(Taint). 以下为内置毒点(Taint):</p>
<ul>
<li><code>node.kubernetes.io/not-ready</code>: 节点还没有就绪。 这对应的节点状态(NodeCondition) <code>Ready</code> 是 &ldquo;<code>False</code>&rdquo;</li>
<li><code>node.kubernetes.io/unreachable</code>: 节点控制器连接不到节点。 这对应的节点状态(NodeCondition) <code>Ready</code> 是 &ldquo;<code>Unknown</code>&rdquo;</li>
<li><code>node.kubernetes.io/out-of-disk</code>: 节点硬盘不足</li>
<li><code>node.kubernetes.io/memory-pressure</code>: 节点有内存使用紧张</li>
<li><code>node.kubernetes.io/disk-pressure</code>: 节点有硬盘使用紧张</li>
<li><code>node.kubernetes.io/network-unavailable</code>: 节点网络不可用</li>
<li><code>node.kubernetes.io/unschedulable</code>: 节点不能作为调度目标</li>
<li><code>node.cloudprovider.kubernetes.io/uninitialized</code>: 当 kubelet 使用&quot;外部&quot;云提供商启动时，
使用这个 毒点(Taint) 将其标记为不可用。 在 <code>cloud-controller-manager</code> 中的控制器初始化这
个节点之后， kubelet 会移除这个毒点(Taint)</li>
</ul>
<p>有一种情况是一个节点被驱逐了，节点控制器或 kubelet 会添加相应效果为 <code>NoExecute</code> 的毒点(Taint)。
如果这个节点从错误状态重新变回正常状态节点控制器或 kubelet 会移除相应的毒点(Taint)。</p>
<blockquote class="note">
  <div><strong>说明：</strong> 控制中心会限制添加到节点上的 毒点(Taint) 的速率。这个速率限制是在许多节点一下都变得不可达时管理
被驱逐的数量(例如: 发生了网络抖动)</div>
</blockquote>

<p>可以为 Pod 指定 <code>tolerationSeconds</code> 来定义在节点失效或不响应时继续让这个 Pod 保持在这个节点
上的时间。</p>
<p>例如，当一个有许多本地状态应用与在出现网络分区的情况下继续保持在这个节点上相当长一段时间，以期望
这个分区在些期间能够恢复，这样可以避免 Pod 被驱逐。 设置在这个 Pod 上的耐受性(Toleration)可能
会长成这个样子:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">tolerations</span>:
- <span style="color:#f92672">key</span>: <span style="color:#e6db74">&#34;node.kubernetes.io/unreachable&#34;</span>
  <span style="color:#f92672">operator</span>: <span style="color:#e6db74">&#34;Exists&#34;</span>
  <span style="color:#f92672">effect</span>: <span style="color:#e6db74">&#34;NoExecute&#34;</span>
  <span style="color:#f92672">tolerationSeconds</span>: <span style="color:#ae81ff">6000</span>
</code></pre></div><blockquote class="note">
  <div><strong>说明：</strong> <p>除非有用户或控制器显示地设置这些 耐受性(Toleration)，否则 k8s 会自动地在添加
<code>node.kubernetes.io/not-ready</code> 和 <code>node.kubernetes.io/unreachable</code> 在其中设置
<code>tolerationSeconds=300</code></p>
<p>这些自动添加耐受性(Toleration)表示，在侦测到这个问题时 Pod 最多还会在这个节点上保留 5 分钟。</p>
</div>
</blockquote>

<p><a href="/k8sDocs/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a> 的 Pod 在创建时会指定
下面这些毒点(Taint)对应的效果为 <code>NoExecute</code> 并且没有 <code>tolerationSeconds</code> 的耐受性(Toleration):</p>
<ul>
<li><code>node.kubernetes.io/unreachable</code></li>
<li><code>node.kubernetes.io/not-ready</code></li>
</ul>
<p>这会确保 DaemonSet 的 Pod 永远不会因为这些原因而被驱逐。</p>
<!--
## Taint Nodes by Condition

The node lifecycle controller automatically creates taints corresponding to
Node conditions with `NoSchedule` effect.
Similarly the scheduler does not check Node conditions; instead the scheduler checks taints. This assures that Node conditions don't affect what's scheduled onto the Node. The user can choose to ignore some of the Node's problems (represented as Node conditions) by adding appropriate Pod tolerations.

The DaemonSet controller automatically adds the following `NoSchedule`
tolerations to all daemons, to prevent DaemonSets from breaking.

  * `node.kubernetes.io/memory-pressure`
  * `node.kubernetes.io/disk-pressure`
  * `node.kubernetes.io/out-of-disk` (*only for critical pods*)
  * `node.kubernetes.io/unschedulable` (1.10 or later)
  * `node.kubernetes.io/network-unavailable` (*host network only*)

Adding these tolerations ensures backward compatibility. You can also add
arbitrary tolerations to DaemonSets.
 -->
<h2 id="taint-nodes-by-condition">根据条件给节点上毒点(Taint)</h2>
<p>节点的生命周期控制自动地根据节点状况创建 <code>NoSchedule</code> 效果的毒点(Taint)。
类似地，调度是不会检查节点状况的；替代方式是调度器检查毒点(Taint)。 这样做能保证节点状况不会影响
已经调度到这个节点上的工作负载。 用户也可以通过向 Pod 上添加对应的耐受性(Toleration)
选择忽略一个节点上的问题(以节点状况表示的)。</p>
<p>DaemonSet 控制器自动添加以下 <code>NoSchedule</code> 耐受性(Toleration)到所有的守护进程， 防止 DaemonSet 挂掉。</p>
<ul>
<li><code>node.kubernetes.io/memory-pressure</code></li>
<li><code>node.kubernetes.io/disk-pressure</code></li>
<li><code>node.kubernetes.io/out-of-disk</code> (<em>仅对关键 Pod</em>)</li>
<li><code>node.kubernetes.io/unschedulable</code> (v1.10+)</li>
<li><code>node.kubernetes.io/network-unavailable</code> (<em>仅主机网络</em>)</li>
</ul>
<p>添加这些 耐受性(Toleration) 能确保向后兼容。 用户还可以向 DaemonSet 添加任意 耐受性(Toleration)</p>
<h2 id="相关资料">相关资料</h2>
<!--
* Read about [out of resource handling](/docs/tasks/administer-cluster/out-of-resource/) and how you can configure it
* Read about [pod priority](/docs/concepts/configuration/pod-priority-preemption/)
 -->
<ul>
<li>实践 <a href="/k8sDocs/docs/tasks/administer-cluster/out-of-resource/">资源不足的处理</a> 与配置</li>
<li>概念 <a href="/k8sDocs/docs/concepts/configuration/pod-priority-preemption/">Pod 优先级</a></li>
</ul>



            
            <div class="text-muted mt-5 pt-3 border-top">最后修改 2021-02-03 14:44:00: <a  href="https://github.com/lostsquirrel/k8sDocs/commit/46aae6e657bd28ec9898536f8394d1d21fa2a9cd">publish taint and toleration (46aae6e)</a>
</div>
            
          </main>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            






<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">











<a href="https://github.com/lostsquirrel/k8sDocs/edit/master/content/zh/docs/concepts/scheduling-eviction/taint-and-toleration.md" target="_blank"><i class="fa fa-edit fa-fw"></i> 编辑此页</a>
<a href="https://github.com/lostsquirrel/k8sDocs/new/master/content/zh/docs/concepts/scheduling-eviction/taint-and-toleration.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> 添加子页面</a>
<a href="https://github.com/lostsquirrel/k8sDocs/issues/new?title=%e6%af%92%e7%82%b9%28Taint%29%e4%b8%8e%e8%80%90%e5%8f%97%e6%80%a7%28Toleration%29" target="_blank"><i class="fab fa-github fa-fw"></i> 提交文档问题</a>

</div>






<nav id="TableOfContents">
  <ul>
    <li><a href="#concepts">概念</a></li>
    <li><a href="#example-use-cases">使用场景示例</a></li>
    <li><a href="#taint-based-evictions">基于毒点(Taint) 的驱逐</a></li>
    <li><a href="#taint-nodes-by-condition">根据条件给节点上毒点(Taint)</a></li>
    <li><a href="#相关资料">相关资料</a></li>
  </ul>
</nav>



          </div>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>











<script src="/k8sDocs/js/main.min.446a2e681f8167f44314691b77368dd561bf0b67514487f3f0fd999316c6da4a.js" integrity="sha256-RGouaB&#43;BZ/RDFGkbdzaN1WG/C2dRRIfz8P2ZkxbG2ko=" crossorigin="anonymous"></script>




  </body>
</html>